var ae=Object.defineProperty;var te=(n,s,r)=>s in n?ae(n,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[s]=r;var E=(n,s,r)=>te(n,typeof s!="symbol"?s+"":s,r);import{a as U,u as D,j as e,P as R,f as I,d as oe,x as ne,X as O,U as ie,b as ce,Y as de,Z as le}from"./ui-8LkqUuQ1.js";import{r as c}from"./vendor-DH0FW2o-.js";import{Q as me,j as $,R as ue,m as pe,t as xe,S as he,N as fe,C as w,T as j,I as N,V as be,h as ve,W as ye,F as ge}from"./index-DJ-Zc7gD.js";import{a as je}from"./router-DNfABZAc.js";import{C as Ne}from"./credit-card-CxEM56tP.js";import{W as we}from"./wallet-pzP2r6KL.js";import{C as Ce}from"./circle-alert-NNggG3O2.js";import{C as T}from"./circle-check-LsiX4M5g.js";import"./utils-BladrqYR.js";import"./forms-DPxY1lef.js";var F="Radio",[Re,V]=U(F),[Pe,Se]=Re(F),q=c.forwardRef((n,s)=>{const{__scopeRadio:r,name:o,checked:a=!1,required:t,disabled:d,value:l="on",onCheck:p,form:x,...b}=n,[h,v]=c.useState(null),m=D(s,g=>v(g)),f=c.useRef(!1),y=h?x||!!h.closest("form"):!0;return e.jsxs(Pe,{scope:r,checked:a,disabled:d,children:[e.jsx(R.button,{type:"button",role:"radio","aria-checked":a,"data-state":B(a),"data-disabled":d?"":void 0,disabled:d,value:l,...b,ref:m,onClick:I(n.onClick,g=>{a||p==null||p(),y&&(f.current=g.isPropagationStopped(),f.current||g.stopPropagation())})}),y&&e.jsx(z,{control:h,bubbles:!f.current,name:o,value:l,checked:a,required:t,disabled:d,form:x,style:{transform:"translateX(-100%)"}})]})});q.displayName=F;var L="RadioIndicator",K=c.forwardRef((n,s)=>{const{__scopeRadio:r,forceMount:o,...a}=n,t=Se(L,r);return e.jsx(oe,{present:o||t.checked,children:e.jsx(R.span,{"data-state":B(t.checked),"data-disabled":t.disabled?"":void 0,...a,ref:s})})});K.displayName=L;var ke="RadioBubbleInput",z=c.forwardRef(({__scopeRadio:n,control:s,checked:r,bubbles:o=!0,...a},t)=>{const d=c.useRef(null),l=D(d,t),p=me(r),x=ne(s);return c.useEffect(()=>{const b=d.current;if(!b)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(p!==r&&m){const f=new Event("click",{bubbles:o});m.call(b,r),b.dispatchEvent(f)}},[p,r,o]),e.jsx(R.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:l,style:{...a.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});z.displayName=ke;function B(n){return n?"checked":"unchecked"}var Ee=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],P="RadioGroup",[Te,Ye]=U(P,[O,V]),Y=O(),W=V(),[_e,Ie]=Te(P),J=c.forwardRef((n,s)=>{const{__scopeRadioGroup:r,name:o,defaultValue:a,value:t,required:d=!1,disabled:l=!1,orientation:p,dir:x,loop:b=!0,onValueChange:h,...v}=n,m=Y(r),f=ie(x),[y,g]=ce({prop:t,defaultProp:a??null,onChange:h,caller:P});return e.jsx(_e,{scope:r,name:o,required:d,disabled:l,value:y,onValueChange:g,children:e.jsx(de,{asChild:!0,...m,orientation:p,dir:f,loop:b,children:e.jsx(R.div,{role:"radiogroup","aria-required":d,"aria-orientation":p,"data-disabled":l?"":void 0,dir:f,...v,ref:s})})})});J.displayName=P;var H="RadioGroupItem",X=c.forwardRef((n,s)=>{const{__scopeRadioGroup:r,disabled:o,...a}=n,t=Ie(H,r),d=t.disabled||o,l=Y(r),p=W(r),x=c.useRef(null),b=D(s,x),h=t.value===a.value,v=c.useRef(!1);return c.useEffect(()=>{const m=y=>{Ee.includes(y.key)&&(v.current=!0)},f=()=>v.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",f),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",f)}},[]),e.jsx(le,{asChild:!0,...l,focusable:!d,active:h,children:e.jsx(q,{disabled:d,required:t.required,checked:h,...p,...a,name:t.name,ref:b,onCheck:()=>t.onValueChange(a.value),onKeyDown:I(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:I(a.onFocus,()=>{var m;v.current&&((m=x.current)==null||m.click())})})})});X.displayName=H;var Ae="RadioGroupIndicator",Q=c.forwardRef((n,s)=>{const{__scopeRadioGroup:r,...o}=n,a=W(r);return e.jsx(K,{...a,...o,ref:s})});Q.displayName=Ae;var Z=J,ee=X,De=Q;const se=c.forwardRef(({className:n,...s},r)=>e.jsx(Z,{className:$("grid gap-2",n),...s,ref:r}));se.displayName=Z.displayName;const A=c.forwardRef(({className:n,...s},r)=>e.jsx(ee,{ref:r,className:$("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),...s,children:e.jsx(De,{className:"flex items-center justify-center",children:e.jsx(ue,{className:"h-2.5 w-2.5 fill-current text-current"})})}));A.displayName=ee.displayName;class Fe{constructor(){E(this,"publicKey");E(this,"isSandbox");this.publicKey="pk_test_sandbox_key",this.isSandbox=!0}async initializeTap(){return new Promise((s,r)=>{if(typeof window>"u"){r(new Error("Window is not defined"));return}if(window.Tap){s();return}const o=document.createElement("script");o.src=(this.isSandbox,"https://tap-sdks.b-cdn.net/card-sdk/v2/tap-card.js"),o.async=!0,o.onload=()=>s(),o.onerror=()=>r(new Error("Failed to load Tap Payment SDK")),document.body.appendChild(o)})}async createCharge(s){var r,o,a;try{if(console.log("üîí TAP: Creating payment charge",{amount:(r=s.order)==null?void 0:r.amount,sandbox:this.isSandbox}),this.isSandbox)return await new Promise(l=>setTimeout(l,2e3)),{id:`ch_sandbox_${Date.now()}`,status:"CAPTURED",amount:((o=s.order)==null?void 0:o.amount)||0,currency:((a=s.order)==null?void 0:a.currency)||"USD",customer:s.customer,transaction:{authorization_id:`auth_sandbox_${Date.now()}`}};const t=await fetch("https://api.tap.company/v2/charges",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.publicKey}`},body:JSON.stringify(s)});if(!t.ok)throw new Error("Payment charge failed");return await t.json()}catch(t){throw console.error("‚ùå TAP: Payment failed",t),t}}async verifyPayment(s){try{if(console.log("üîç TAP: Verifying payment",s),this.isSandbox)return{id:s,status:"CAPTURED",amount:0,currency:"USD",customer:{},transaction:{authorization_id:"auth_sandbox"}};const r=await fetch(`https://api.tap.company/v2/charges/${s}`,{headers:{Authorization:`Bearer ${this.publicKey}`}});if(!r.ok)throw new Error("Payment verification failed");return await r.json()}catch(r){throw console.error("‚ùå TAP: Verification failed",r),r}}async processCardPayment(s,r,o="USD"){try{console.log("üí≥ TAP: Processing card payment",{amount:r,currency:o,sandbox:this.isSandbox});const a=s.expiry.split("/");if(a.length!==2)throw new Error("Invalid expiry date format. Use MM/YY");const[t,d]=a.map(l=>l.trim());if(!t||!d||t.length!==2||d.length!==2)throw new Error("Invalid expiry date format. Use MM/YY");if(this.isSandbox){const l=["4111111111111111","5200000000000007"],p=s.number.replace(/\s/g,"");if(await new Promise(x=>setTimeout(x,2e3)),l.includes(p))return{id:`ch_sandbox_${Date.now()}`,status:"CAPTURED",amount:r,currency:o,customer:{name:s.name},transaction:{authorization_id:`auth_sandbox_${Date.now()}`}};throw new Error("Card declined. Use test card: 4111 1111 1111 1111")}throw new Error("Production mode not implemented. Use sandbox mode.")}catch(a){throw console.error("‚ùå TAP: Card payment failed",a),a}}getTestCards(){return[{number:"4111 1111 1111 1111",type:"Visa",result:"Success",cvv:"123",expiry:"12/25"},{number:"5200 0000 0000 0007",type:"Mastercard",result:"Success",cvv:"123",expiry:"12/25"}]}isSandboxMode(){return this.isSandbox}}const C=new Fe,_=[{name:"Steam Account - 200+ Games",price:449.99},{name:"Instagram Account - 50K Followers",price:299.99}],We=()=>{const n=je(),{toast:s}=pe(),{user:r}=xe(),[o,a]=c.useState(!1),[t,d]=c.useState(!1),[l,p]=c.useState(""),[x,b]=c.useState(""),[h,v]=c.useState(""),[m,f]=c.useState(""),[y,g]=c.useState((r==null?void 0:r.email)||""),S=_.reduce((i,u)=>i+u.price,0),M=S*.03,k=S+M,G=C.isSandboxMode()?C.getTestCards():[],re=async()=>{if(!y){s({title:"Email required",description:"Please enter your email address.",variant:"destructive"});return}if(!l||!x||!h||!m){s({title:"Card details incomplete",description:"Please fill in all card details.",variant:"destructive"});return}if(!t){s({title:"Terms required",description:"You must agree to the Terms of Service and Refund Policy.",variant:"destructive"});return}a(!0);try{s({title:"Processing payment...",description:"Please wait while we process your payment securely."});const i=await C.processCardPayment({number:l.replace(/\s/g,""),name:x,expiry:h,cvv:m},k,"USD");console.log("‚úÖ Payment successful:",i),s({title:"Payment successful! üéâ",description:`Your order has been placed. Transaction ID: ${i.id}`});const u={id:i.id,status:"completed",total:k,items:_,paymentMethod:"Credit Card",orderDate:new Date().toISOString(),estimatedDelivery:new Date(Date.now()+24*60*60*1e3).toISOString()};localStorage.setItem("last_order",JSON.stringify(u)),setTimeout(()=>{n("/order-confirmation")},2e3)}catch(i){console.error("‚ùå Payment failed:",i),s({title:"Payment failed",description:i.message||"There was an error processing your payment. Please try again.",variant:"destructive"})}finally{a(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col relative",children:[e.jsx(he,{}),e.jsx(fe,{}),e.jsx("main",{className:"flex-1 relative z-10 py-16",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-black bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent mb-2",children:"Checkout"}),e.jsx("p",{className:"text-foreground/60 text-sm sm:text-base",children:"Complete your purchase securely"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6 lg:gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(w,{className:"glass-card p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground mb-6",children:"Contact Information"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{htmlFor:"email",children:["Email Address ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(N,{id:"email",type:"email",placeholder:"your@email.com",className:"glass-card border-border/50 bg-muted/50",value:y,readOnly:!0,required:!0})]})})]}),e.jsxs(w,{className:"glass-card p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground mb-6",children:"Payment Method"}),e.jsxs(se,{defaultValue:"card",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-4 rounded-lg glass-card border border-border/50 cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx(A,{value:"card",id:"card"}),e.jsxs(j,{htmlFor:"card",className:"flex items-center gap-3 cursor-pointer flex-1",children:[e.jsx(Ne,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground",children:"Credit / Debit Card"}),e.jsx("p",{className:"text-sm text-foreground/60",children:"Pay with your card"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 rounded-lg glass-card border border-border/50 cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx(A,{value:"wallet",id:"wallet"}),e.jsxs(j,{htmlFor:"wallet",className:"flex items-center gap-3 cursor-pointer flex-1",children:[e.jsx(we,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground",children:"Wallet Balance"}),e.jsx("p",{className:"text-sm text-foreground/60",children:"Use your wallet: $1,249.50"})]})]})]})]}),C.isSandboxMode()&&G.length>0&&e.jsxs("div",{className:"mt-6 p-4 rounded-lg bg-blue-500/10 border border-blue-500/20",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx(Ce,{className:"h-5 w-5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-blue-500",children:"Sandbox Mode - Test Cards"}),e.jsx("p",{className:"text-sm text-blue-500/80 mt-1",children:"Use these test cards for testing:"})]})]}),G.map((i,u)=>e.jsxs("div",{className:"text-xs text-blue-500/70 mt-2 font-mono",children:[e.jsxs("strong",{children:[i.type,":"]})," ",i.number," | Exp: ",i.expiry," | CVV: ",i.cvv]},u))]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{htmlFor:"cardName",children:["Cardholder Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(N,{id:"cardName",placeholder:"John Doe",className:"glass-card border-border/50",value:x,onChange:i=>b(i.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{htmlFor:"cardNumber",children:["Card Number ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(N,{id:"cardNumber",placeholder:"4111 1111 1111 1111",className:"glass-card border-border/50",value:l,onChange:i=>p(i.target.value),maxLength:19,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{htmlFor:"expiry",children:["Expiry Date (MM/YY) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(N,{id:"expiry",placeholder:"01/25",className:"glass-card border-border/50",value:h,onChange:i=>{let u=i.target.value;u=u.replace(/[^0-9/]/g,""),u.length>=2&&!u.includes("/")&&(u=u.substring(0,2)+"/"+u.substring(2)),u.length<=5&&v(u)},maxLength:5,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{htmlFor:"cvv",children:["CVV ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(N,{id:"cvv",placeholder:"123",className:"glass-card border-border/50",value:m,onChange:i=>f(i.target.value),maxLength:4,required:!0})]})]})]})]}),e.jsx(w,{className:"glass-card p-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(be,{id:"terms",className:"mt-1",checked:t,onCheckedChange:i=>d(i)}),e.jsxs("label",{htmlFor:"terms",className:"text-sm text-foreground/70 leading-relaxed cursor-pointer",children:[e.jsx("span",{className:"text-destructive",children:"* "}),"I agree to the"," ",e.jsx("a",{href:"/terms",target:"_blank",className:"text-primary hover:text-primary/80 underline",children:"Terms of Service"}),","," ",e.jsx("a",{href:"/refund-policy",target:"_blank",className:"text-primary hover:text-primary/80 underline",children:"Refund Policy"}),", and understand that all sales are final once the product is delivered."]})]})})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(w,{className:"glass-card p-6 sticky top-4",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground mb-6",children:"Order Summary"}),e.jsx("div",{className:"space-y-3 mb-6 pb-6 border-b border-border/30",children:_.map((i,u)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-foreground/70 line-clamp-1",children:i.name}),e.jsxs("span",{className:"font-semibold text-foreground whitespace-nowrap ml-2",children:["$",i.price.toFixed(2)]})]},u))}),e.jsxs("div",{className:"space-y-3 mb-6 pb-6 border-b border-border/30",children:[e.jsxs("div",{className:"flex justify-between text-foreground/70",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["$",S.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-foreground/70",children:[e.jsx("span",{children:"Service Fee (3%)"}),e.jsxs("span",{className:"font-semibold",children:["$",M.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-bold text-foreground",children:"Total"}),e.jsxs("span",{className:"text-2xl font-black bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:["$",k.toFixed(2)]})]})]}),e.jsxs(ve,{className:"w-full btn-glow mb-4",size:"lg",onClick:re,disabled:o||!t,children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),o?"Processing...":"Complete Purchase"]}),!t&&e.jsx("p",{className:"text-xs text-destructive text-center mb-4",children:"Please agree to Terms of Service to continue"}),e.jsxs("div",{className:"space-y-2 text-sm text-foreground/60",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4 text-primary"}),e.jsx("span",{children:"Secure encrypted payment"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4 text-primary"}),e.jsx("span",{children:"Instant delivery"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4 text-primary"}),e.jsx("span",{children:"7-day money back guarantee"})]})]})]})})]})]})}),e.jsx(ge,{})]})};export{We as default};
