import{j as r}from"./ui-8LkqUuQ1.js";import{r as u}from"./vendor-DH0FW2o-.js";import{$ as I,T as v}from"./index-BXMhu9HI.js";import{D as N,C as m}from"./ConfirmDialog-DB6HcN8r.js";import{m as k,B as p}from"./index-DJ-Zc7gD.js";import{a as E}from"./router-DNfABZAc.js";import{C as f}from"./credit-card-CxEM56tP.js";import{R as x}from"./rotate-ccw-lDOuJzXn.js";import{f as D}from"./utils-BladrqYR.js";import"./table-8L0bK-M7.js";import"./ellipsis-D_jF052c.js";import"./eye-eHhB2xYa.js";import"./square-pen-DgF4O29M.js";import"./trash-2-D_VMLyqA.js";import"./chevron-left-CIsvNeiC.js";import"./forms-DPxY1lef.js";function K(){const h=E(),{toast:s}=k(),[o,n]=u.useState({open:!1,orderId:null}),[a,d]=u.useState({open:!1,orderId:null}),{data:t,isLoading:g,refetch:i}=I({resource:"orders",pagination:{current:1,pageSize:10}}),{mutate:l}=v(),w=e=>{n({open:!0,orderId:e})},j=e=>{d({open:!0,orderId:e})},y=()=>{o.orderId&&l({resource:"orders",id:o.orderId,values:{escrow_status:"released"}},{onSuccess:()=>{s({title:"Escrow Released",description:"Funds have been released to the seller."}),i()},onError:()=>{s({title:"Error",description:"Failed to release escrow.",variant:"destructive"})}}),n({open:!1,orderId:null})},R=()=>{a.orderId&&l({resource:"orders",id:a.orderId,values:{escrow_status:"refunded"}},{onSuccess:()=>{s({title:"Refund Processed",description:"Order has been refunded to the buyer."}),i()},onError:()=>{s({title:"Error",description:"Failed to process refund.",variant:"destructive"})}}),d({open:!1,orderId:null})},b=[{key:"buyer",title:"Buyer",dataIndex:"buyer",render:e=>r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:e.email})]})},{key:"seller",title:"Seller",dataIndex:"seller",render:e=>r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e.name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:e.email})]})},{key:"amount",title:"Amount",dataIndex:"amount",render:e=>`$${e.toFixed(2)}`},{key:"escrow_status",title:"Escrow Status",dataIndex:"escrow_status",render:e=>r.jsx(p,{variant:e==="released"?"default":e==="held"?"secondary":e==="refunded"?"destructive":"outline",className:"capitalize",children:e})},{key:"dispute_flag",title:"Dispute",dataIndex:"dispute_flag",render:e=>r.jsx(p,{variant:e?"destructive":"secondary",children:e?"Yes":"No"})},{key:"created_at",title:"Created",dataIndex:"created_at",render:e=>D(new Date(e),"MMM dd, yyyy")}],C=[{label:"Release Escrow",onClick:()=>c("Release Escrow"),icon:r.jsx(f,{className:"h-4 w-4"})},{label:"Process Refund",onClick:()=>c("Process Refund"),icon:r.jsx(x,{className:"h-4 w-4"})}],c=e=>{s({title:"Bulk Action",description:`${e} applied to selected orders.`})};return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Orders"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage orders and escrow transactions"})]})}),r.jsx(N,{data:(t==null?void 0:t.data)||[],columns:b,loading:g,pagination:{current:1,pageSize:10,total:(t==null?void 0:t.total)||0,onChange:(e,S)=>{}},actions:{view:e=>h(`/admin/orders/${e.id}`),custom:[{label:"Release Escrow",onClick:e=>w(e.id),icon:r.jsx(f,{className:"h-4 w-4"})},{label:"Refund",onClick:e=>j(e.id),icon:r.jsx(x,{className:"h-4 w-4"})}]},bulkActions:C}),r.jsx(m,{open:o.open,onOpenChange:e=>n({open:e,orderId:null}),title:"Release Escrow",description:"Are you sure you want to release the escrow funds to the seller? This action cannot be undone.",confirmText:"Release",onConfirm:y}),r.jsx(m,{open:a.open,onOpenChange:e=>d({open:e,orderId:null}),title:"Process Refund",description:"Are you sure you want to refund this order to the buyer? This action cannot be undone.",confirmText:"Refund",variant:"destructive",onConfirm:R})]})}export{K as default};
