import{r}from"./vendor-DQvVfnsa.js";import{as as F,a1 as I,ar as L,a4 as $}from"./index-DDQE-usx.js";function M({endpoint:m,initialSearchTerm:P="",pageSize:h=25,queryKey:y}){var f,d;const g=F(),[S,c]=r.useState(!1),[o,C]=r.useState(P),[t,Q]=r.useState({page:1,limit:h,total:0,totalPages:0}),l=y||["admin-list",m],{data:a,isLoading:w,refetch:u}=I({queryKey:[...l,t.page,t.limit,o],queryFn:async()=>{const i=new URLSearchParams({page:t.page.toString(),limit:t.limit.toString()});o&&i.append("search",o);const e=await $.request(`/admin${m}?${i}`);let s=[],n={total:0,totalPages:0};return Array.isArray(e)?(s=e,n={total:e.length,totalPages:Math.ceil(e.length/t.limit)}):e.data&&(s=e.data,e.pagination&&(n={total:e.pagination.total||0,totalPages:e.pagination.total_pages||0})),{items:s,pagination:n}},staleTime:30*1e3,gcTime:5*60*1e3,retry:1,onError:i=>{console.error(`Failed to fetch ${m}:`,i),L.error("Failed to load data",{description:i.message||"An error occurred while loading data"})}}),A=(a==null?void 0:a.items)||[],K=r.useMemo(()=>{var i,e;return{page:t.page,limit:t.limit,total:((i=a==null?void 0:a.pagination)==null?void 0:i.total)??t.total,totalPages:((e=a==null?void 0:a.pagination)==null?void 0:e.totalPages)??t.totalPages}},[t.page,t.limit,t.total,t.totalPages,(f=a==null?void 0:a.pagination)==null?void 0:f.total,(d=a==null?void 0:a.pagination)==null?void 0:d.totalPages]),T=r.useCallback((i,e)=>{c(!0);const s=[...l,t.page,t.limit,o];g.setQueryData(s,n=>n&&{...n,items:n.items.map(p=>p.id===i?{...p,...e}:p)}),c(!1)},[g,l,t.page,t.limit,o]),b=r.useCallback(i=>{c(!0);const e=[...l,t.page,t.limit,o];g.setQueryData(e,s=>s&&{...s,items:s.items.filter(n=>n.id!==i)}),c(!1)},[g,l,t.page,t.limit,o]),k=r.useCallback(async()=>{await u()},[u]);return{data:A,isLoading:w,isProcessing:S,searchTerm:o,setSearchTerm:C,pagination:K,setPagination:i=>{Q(e=>({...e,...i}))},refetch:k,updateItem:T,deleteItem:b}}export{M as u};
//# sourceMappingURL=useAdminList-B1aPYsbX.js.map
